
<!DOCTYPE html>


<html>
	<head>
		<meta charset="utf-8">
	    
	    <title>Trackback Class &mdash; CodeIgniter 3.0-dev documentation</title>

	    <link rel="stylesheet" href="../_static/asset/css/common.css" type="text/css" />
	    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
	    <script type="text/javascript">
	      var DOCUMENTATION_OPTIONS = {
	        URL_ROOT:    '../',
	        VERSION:     '3.0-dev',
	        COLLAPSE_INDEX: false,
	        FILE_SUFFIX: '.html',
	        HAS_SOURCE:  true
	      };
	    </script>
	    <script type="text/javascript" src="../_static/jquery.js"></script>
	    <script type="text/javascript" src="../_static/underscore.js"></script>
	    <script type="text/javascript" src="../_static/doctools.js"></script>
	    <link rel="top" title="CodeIgniter 3.0-dev documentation" href="../index.html" />
	    <link rel="up" title="Libraries" href="index.html" />
	    <link rel="next" title="Typography Class" href="typography.html" />
	    <link rel="prev" title="HTML Table Class" href="table.html" /> 
	</head>
	<body>
		<div id="table-contents">
			<div class="toctree-wrapper compound">
			<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">General Topics</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="benchmark.html">Benchmarking Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html">Caching Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="calendar.html">Calendaring Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="cart.html">Shopping Cart Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Config Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Email Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="encryption.html">Encryption Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_uploading.html">File Uploading Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="form_validation.html">Form Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftp.html">FTP Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_lib.html">Image Manipulation Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html">Input Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html">Javascript Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="language.html">Language Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader.html">Loader Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration.html">Migrations Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Pagination Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.html">Template Parser Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Session Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="table.html">HTML Table Class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Trackback Class</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="typography.html">Typography Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing.html">Unit Testing Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html">URI Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_agent.html">User Agent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmlrpc.html">XML-RPC and XML-RPC Server Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="zip.html">Zip Encoding Class</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Helpers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to CodeIgniter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DCO.html">Developer&#8217;s Certificate of Origin 1.1</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../DCO.html">Developer&#8217;s Certificate of Origin 1.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Open Software License (&#8220;OSL&#8221;) v 3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license_afl.html">Academic Free License (&#8220;AFL&#8221;) v 3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">CodeIgniter Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/requirements.html">Server Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/welcome.html">Welcome to CodeIgniter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">General Topics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="benchmark.html">Benchmarking Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html">Caching Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="calendar.html">Calendaring Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="cart.html">Shopping Cart Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Config Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Email Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="encryption.html">Encryption Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_uploading.html">File Uploading Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="form_validation.html">Form Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftp.html">FTP Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_lib.html">Image Manipulation Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html">Input Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html">Javascript Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="language.html">Language Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader.html">Loader Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration.html">Migrations Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Pagination Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="parser.html">Template Parser Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Session Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="table.html">HTML Table Class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Trackback Class</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="typography.html">Typography Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing.html">Unit Testing Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html">URI Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_agent.html">User Agent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="xmlrpc.html">XML-RPC and XML-RPC Server Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="zip.html">Zip Encoding Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">The Database Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Writing CodeIgniter Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/quick_reference.html">Quick Reference Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/credits.html">Credits</a></li>
</ul>

			</div>
		</div>

		<div id="brand" class="ci">
			<a href="http://codeigniter.com/"><img src="../_static/asset/img/ci-logo.gif" alt="CodeIgniter"></a>
			<p>3.0-dev User Guide</p>
		</div><!-- /#brand -->

		<div id="header">
			<form method="get" action="http://www.google.com/search">
				<fieldset>
					<input type="text" name="q" id="q" value="">
					<input type="hidden" name="as_sitesearch" id="as_sitesearch" value="codeigniter.com/user_guide/" />
					<input class="grades" type="submit" value="search">
				</fieldset>
			</form>
			<ul>
				<li><a href="../index.html">User Guide Home</a>&nbsp;&nbsp; &rsaquo;</li>
				<li><a href="index.html" accesskey="U">Libraries</a>&nbsp;&nbsp;  &rsaquo;</li>
				<li><strong>Trackback Class</strong></li>
			</ul>
		</div><!-- /#header -->

		<div class="section" id="content">
			<div class="section" id="trackback-class">
<h1>Trackback Class<a class="headerlink" href="#trackback-class" title="Permalink to this headline">¶</a></h1>
<p>The Trackback Class provides functions that enable you to send and
receive Trackback data.</p>
<p>If you are not familiar with Trackbacks you&#8217;ll find more information
<a class="reference external" href="http://en.wikipedia.org/wiki/Trackback">here</a>.</p>
<div class="section" id="initializing-the-class">
<h2>Initializing the Class<a class="headerlink" href="#initializing-the-class" title="Permalink to this headline">¶</a></h2>
<p>Like most other classes in CodeIgniter, the Trackback class is
initialized in your controller using the $this-&gt;load-&gt;library function:</p>
<div class="highlight-ci"><pre>$this-&gt;load-&gt;library('trackback');</pre>
</div>
<p>Once loaded, the Trackback library object will be available using:
$this-&gt;trackback</p>
</div>
<div class="section" id="sending-trackbacks">
<h2>Sending Trackbacks<a class="headerlink" href="#sending-trackbacks" title="Permalink to this headline">¶</a></h2>
<p>A Trackback can be sent from any of your controller functions using code
similar to this example:</p>
<div class="highlight-ci"><pre>$this-&gt;load-&gt;library('trackback');

$tb_data = array(
                'ping_url'  =&gt; 'http://example.com/trackback/456',
                'url'       =&gt; 'http://www.my-example.com/blog/entry/123',
                'title'     =&gt; 'The Title of My Entry',
                'excerpt'   =&gt; 'The entry content.',
                'blog_name' =&gt; 'My Blog Name',
                'charset'   =&gt; 'utf-8'
                );

if ( ! $this-&gt;trackback-&gt;send($tb_data))
{
     echo $this-&gt;trackback-&gt;display_errors();
}
else
{
     echo 'Trackback was sent!';
}</pre>
</div>
<p>Description of array data:</p>
<ul class="simple">
<li><strong>ping_url</strong> - The URL of the site you are sending the Trackback to.
You can send Trackbacks to multiple URLs by separating each URL with
a comma.</li>
<li><strong>url</strong> - The URL to YOUR site where the weblog entry can be seen.</li>
<li><strong>title</strong> - The title of your weblog entry.</li>
<li><strong>excerpt</strong> - The content of your weblog entry. Note: the Trackback
class will automatically send only the first 500 characters of your
entry. It will also strip all HTML.</li>
<li><strong>blog_name</strong> - The name of your weblog.</li>
<li><strong>charset</strong> - The character encoding your weblog is written in. If
omitted, UTF-8 will be used.</li>
</ul>
<p>The Trackback sending function returns TRUE/FALSE (boolean) on success
or failure. If it fails, you can retrieve the error message using:</p>
<div class="highlight-ci"><pre>$this-&gt;trackback-&gt;display_errors();</pre>
</div>
</div>
<div class="section" id="receiving-trackbacks">
<h2>Receiving Trackbacks<a class="headerlink" href="#receiving-trackbacks" title="Permalink to this headline">¶</a></h2>
<p>Before you can receive Trackbacks you must create a weblog. If you don&#8217;t
have a blog yet there&#8217;s no point in continuing.</p>
<p>Receiving Trackbacks is a little more complex than sending them, only
because you will need a database table in which to store them, and you
will need to validate the incoming trackback data. You are encouraged to
implement a thorough validation process to guard against spam and
duplicate data. You may also want to limit the number of Trackbacks you
allow from a particular IP within a given span of time to further
curtail spam. The process of receiving a Trackback is quite simple; the
validation is what takes most of the effort.</p>
</div>
<div class="section" id="your-ping-url">
<h2>Your Ping URL<a class="headerlink" href="#your-ping-url" title="Permalink to this headline">¶</a></h2>
<p>In order to accept Trackbacks you must display a Trackback URL next to
each one of your weblog entries. This will be the URL that people will
use to send you Trackbacks (we will refer to this as your &#8220;Ping URL&#8221;).</p>
<p>Your Ping URL must point to a controller function where your Trackback
receiving code is located, and the URL must contain the ID number for
each particular entry, so that when the Trackback is received you&#8217;ll be
able to associate it with a particular entry.</p>
<p>For example, if your controller class is called Trackback, and the
receiving function is called receive, your Ping URLs will look something
like this:</p>
<div class="highlight-ci"><pre>http://example.com/index.php/trackback/receive/entry_id</pre>
</div>
<p>Where entry_id represents the individual ID number for each of your
entries.</p>
</div>
<div class="section" id="creating-a-trackback-table">
<h2>Creating a Trackback Table<a class="headerlink" href="#creating-a-trackback-table" title="Permalink to this headline">¶</a></h2>
<p>Before you can receive Trackbacks you must create a table in which to
store them. Here is a basic prototype for such a table:</p>
<div class="highlight-ci"><pre>CREATE TABLE trackbacks (
 tb_id int(10) unsigned NOT NULL auto_increment,
 entry_id int(10) unsigned NOT NULL default 0,
 url varchar(200) NOT NULL,
 title varchar(100) NOT NULL,
 excerpt text NOT NULL,
 blog_name varchar(100) NOT NULL,
 tb_date int(10) NOT NULL,
 ip_address varchar(16) NOT NULL,
 PRIMARY KEY `tb_id` (`tb_id`),
 KEY `entry_id` (`entry_id`)
);</pre>
</div>
<p>The Trackback specification only requires four pieces of information to
be sent in a Trackback (url, title, excerpt, blog_name), but to make
the data more useful we&#8217;ve added a few more fields in the above table
schema (date, IP address, etc.).</p>
</div>
<div class="section" id="processing-a-trackback">
<h2>Processing a Trackback<a class="headerlink" href="#processing-a-trackback" title="Permalink to this headline">¶</a></h2>
<p>Here is an example showing how you will receive and process a Trackback.
The following code is intended for use within the controller function
where you expect to receive Trackbacks.</p>
<div class="highlight-ci"><pre>$this-&gt;load-&gt;library('trackback');
$this-&gt;load-&gt;database();

if ($this-&gt;uri-&gt;segment(3) == FALSE)
{
    $this-&gt;trackback-&gt;send_error("Unable to determine the entry ID");
}

if ( ! $this-&gt;trackback-&gt;receive())
{
    $this-&gt;trackback-&gt;send_error("The Trackback did not contain valid data");
}

$data = array(
                'tb_id'      =&gt; '',
                'entry_id'   =&gt; $this-&gt;uri-&gt;segment(3),
                'url'        =&gt; $this-&gt;trackback-&gt;data('url'),
                'title'      =&gt; $this-&gt;trackback-&gt;data('title'),
                'excerpt'    =&gt; $this-&gt;trackback-&gt;data('excerpt'),
                'blog_name'  =&gt; $this-&gt;trackback-&gt;data('blog_name'),
                'tb_date'    =&gt; time(),
                'ip_address' =&gt; $this-&gt;input-&gt;ip_address()
                );

$sql = $this-&gt;db-&gt;insert_string('trackbacks', $data);
$this-&gt;db-&gt;query($sql);

$this-&gt;trackback-&gt;send_success();</pre>
</div>
<div class="section" id="notes">
<h3>Notes:<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h3>
<p>The entry ID number is expected in the third segment of your URL. This
is based on the URI example we gave earlier:</p>
<div class="highlight-ci"><pre>http://example.com/index.php/trackback/receive/entry_id</pre>
</div>
<p>Notice the entry_id is in the third URI segment, which you can retrieve
using:</p>
<div class="highlight-ci"><pre>$this-&gt;uri-&gt;segment(3);</pre>
</div>
<p>In our Trackback receiving code above, if the third segment is missing,
we will issue an error. Without a valid entry ID, there&#8217;s no reason to
continue.</p>
<p>The $this-&gt;trackback-&gt;receive() function is simply a validation function
that looks at the incoming data and makes sure it contains the four
pieces of data that are required (url, title, excerpt, blog_name). It
returns TRUE on success and FALSE on failure. If it fails you will issue
an error message.</p>
<p>The incoming Trackback data can be retrieved using this function:</p>
<div class="highlight-ci"><pre>$this-&gt;trackback-&gt;data('item')</pre>
</div>
<p>Where item represents one of these four pieces of info: url, title,
excerpt, or blog_name</p>
<p>If the Trackback data is successfully received, you will issue a success
message using:</p>
<div class="highlight-ci"><pre>$this-&gt;trackback-&gt;send_success();</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above code contains no data validation, which you are
encouraged to add.</p>
</div>
</div>
</div>
</div>

		</div>

		<!-- {user_guide_comments} -->
					
		<div id="footer">
			<p class="top"><a href="#header" title="Return to top">Return to top</a></p>
			<p><a href="">CodeIgniter</a> &ndash; Copyright &copy; 2012, EllisLab, Inc.</a></p>
		</div><!-- /#footer -->
	</body>
</html>